#
#The file records the output of new implementation of hyp2f1 for complex x (chyp2f1), and compares with the original 
#implemenatation as well as mpmath outputs.
#NOTE: When x is complex, the cases to be taken further care are when c is negative; the present FORTRAN
# implementation too fails in such cases at present
#For real x the present implementation remains to be the relatively fool-proof one.
#

#a	b	c	x	chyp2f1	mpmath.hy2f1	hyp2f1	chyp2f1/mp.hyp2f1-1(relative error)

# Negative c yet to be taken care of (present implementation either gives wrong answer or nan)-----------------------------------------
16.773	13	-42.35	0.999j	(nan-inf*j)	(2.51430480441161e+17 - 1.05230423387458e+17j)	(1.11286007919e+19-4.88936954914e+18j)	nan
160	42.35	-42.35	(3+1j)	(nan+nan*j)	(3.83681428201878e+44 - 1.75440043159734e+45j)	(nan+nan*j)	nan
160	42.35	-42.35	3j	(nan+nan*j)	(5593.00984225566 - 7160.28060667703j)	(nan+nan*j)	nan
160	42.35	-42.35	0.3j	0j	(1.01331468791188e+50 - 1.89314554046662e+50j)	(1.01331468791e+50-1.89314554047e+50j)	-1.0
160	42.35	-42.35	(1-0.3j)	(nan-inf*j)	(6.39968243022956e+222 + 1.90436572430974e+222j)	(nan+nan*j)	nan
160	42.35	-42.35	(1-0.0003j)	(nan+nan*j)	(-2.43841026113809e+955 + 5.04608445128747e+955j)	(nan+nan*j)	nan
#--------------------------------------------------------------------------------------------------------------------------------------



#New implementation better than the old one.-------------------------------------------------------------------------------------------

16.773	13	42.35	0.999j	(-0.0276482840573-0.28687035663j)	(-0.0276482840573734 - 0.286870356629699j)	(-7.37558820847e+160-4.18312336973e+160j)	1.791899961745e-13
16	13	42.35	0.999j	(-0.0898071834666-0.297585969428j)	(-0.089807183466627 - 0.297585969428108j)	(8.47885655974e+160-7.63849376944e+159j)	6.46149800331841e-14
12	2.3	40.3	1j	(0.708488280825+0.545284677991j)	(0.708488280824713 + 0.545284677991468j)	(-3.25250816435e+150+7.27763518526e+150j)	0.0
12	2.3	40.3	(0.707106781187+0.707106781187j)	(1.27195007981+0.915121360482j)	(1.27195007980911 + 0.915121360482363j)	(-1.51841047301e+18-2.81780618641e+18j)	2.22044604925031e-16

#Solves issue #1561
1	1	4	(3+4j)	(0.492343828082+0.605134062469j)	(0.492343840009635 + 0.60513406166124j)	(0.659254604748+1.32778872645j)	-8.84610695806032e-9
12	2.3	40	(0.707106781187+0.707106781187j)	(1.27026586541+0.924959611391j)	(1.27026586540961 + 0.924959611391381j)	(3.30826483388e+17+1.00989860078e+18j)	4.44089209850063e-16
12	2	40	(0.707106781187+0.707106781187j)	(1.26815823799+0.769516992301j)	(1.26815823798737 + 0.769516992300966j)	(-1.52691483484e+16+9.93208695481e+16j)	2.22044604925031e-16
122	22	402	(0.707106781187+0.707106781187j)	(80.1883450306-20.1744594582j)	(80.1883450306257 - 20.1744594582381j)	(nan+nan*j)	4.44089209850063e-16
#-------------------------------------------------------------------------------------------------------------------------------------


#error cases: where new implementation is worse than original implementation-----------------------------------------------------------
12	12.2	12.23	(3+4j)	(-2.68912498895e-09+1.77512627764e-10j)	(1.16586162347459e-8 - 1.14804446399043e-8j)	(1.16586162566e-08-1.1480444615e-08j)	-0.835293194210897
#----------------------------------------------------------------------------------------------------------------------------------------



#--------------------------------------none of the implementations working------------------------------------------------------------------
1	2.3	4	1j	(nan+0j)	(0.748217617191783 + 0.401283895456032j)	(3.76614772034e+81-2.89731617114e+81j)	nan
1	2.3	4.3	1j	(nan+0j)	(0.772132784937613 + 0.385418973887682j)	(-5.78132995907e+81+1.30908639265e+82j)	nan
16	42	42.35	0.999j	(nan+nan*j)	(0.00417936807799587 - 0.000372504581351155j)	(-3.85365449813e+147-5.52571275523e+147j)	nan
122	22	40	(0.707106781187+0.707106781187j)	(81159825608.3+63613166576.4j)	(-79.3098585551089 - 146.651876342175j)	(-221076366553+30108394982.2j)	618502665.966585


#-----------------------------General cases (both implementations working well------------------------------------------------
#a	b	c	x	chyp2f1	mpmath.hy2f1	hyp2f1	chyp2f1/mp.hyp2f1-1(Relative error)

1	1	-4	(3+4j)	(inf+0j)	+inf	(inf+0j)	nan
1	1.4	4	0.3	(1.12330023907+0j)	1.12330023906715	1.12330023907	4.44089209850063e-16
1	12	4.3	(3+4j)	(-0.0351520667427+0.0506773561665j)	(-0.0351520667427083 + 0.0506773561664612j)	(-0.0351520667427+0.0506773561665j)	2.22044604925031e-16
16	42.35	42.35	0.999j	(0.00393749919933-3.15164218674e-05j)	(0.00393749919933227 - 3.15164218674032e-5j)	(0.00393749919933-3.15164218674e-05j)	-6.66133814775094e-16
16	42.35	42.35	1j	(0.00390625-1.91344742785e-18j)	(0.00390625 + 0.0j)	(0.00390625-1.91344742785e-18j)	-6.66133814775094e-16
16	42.35	42.35	1.99j	(1.07167224108e-06-2.51027167511e-06j)	(1.07167224108076e-6 - 2.51027167510562e-6j)	(1.07167224108e-06-2.51027167511e-06j)	2.22044604925031e-16
16	42.35	42.35	(3+1.99j)	(6.1987274189e-08+2.48703323823e-09j)	(6.19872741889712e-8 + 2.48703323822814e-9j)	(6.1987274189e-08+2.48703323823e-09j)	1.33226762955019e-15
16	42.35	42.35	(3+1j)	(1.0802495488e-06-2.3209181184e-06j)	(1.0802495488e-6 - 2.3209181184e-6j)	(1.0802495488e-06-2.3209181184e-06j)	-4.44089209850063e-16
160	42.35	42.35	(3+1j)	(4.21559679458e-57+1.13304416242e-56j)	(4.21559679458278e-57 + 1.13304416241642e-56j)	(4.21559679458e-57+1.13304416242e-56j)	-2.4980018054066e-14
1	2	2	(3+4j)	(-0.100000000113+0.199999997808j)	(-0.1 + 0.2j)	(-0.1+0.2j)	-8.54232917735231e-9
12	22	12	(3+4j)	(3.48677957823e-15+3.41821961974e-15j)	(3.4867797e-15 + 3.4182196e-15j)	(3.4867797e-15+3.4182196e-15j)	-1.49786615333269e-8
12	22	12.23	(3+4j)	(4.70737639035e-15+1.05881201892e-15j)	(4.70737639034956e-15 + 1.0588120189247e-15j)	(4.70737637475e-15+1.05881201307e-15j)	6.66133814775094e-16
1	1.4	4	(3+4j)	(0.268796142468+0.618662725857j)	(0.268796142467774 + 0.618662725857424j)	(0.268796142717+0.618662725851j)	2.22044604925031e-16
1	1.4	4.5	(3+4j)	(0.33491198607+0.642401248686j)	(0.334911986070405 + 0.642401248685701j)	(0.334911986264+0.642401248373j)	0.0

#---------------------------------------------------------------------------------------------------------------------------------------


